var rowEl,roleEl,roleElValue,codeEl,codeElValue,list=document.getElementById("list"),addBtn=document.getElementById("addBtn"),orderListBy=document.querySelectorAll("[data-order-by]"),statusModalBtn=document.getElementById("statusModalBtn"),statusModalAlert=document.getElementById("statusModalAlert"),codeInput=document.getElementById("codeInput"),roleInput=document.getElementById("roleInput"),orderBy="role_name",ascOrDesc="ASC";addBtn.addEventListener("click",add,!1),list.addEventListener("click",listBtnFunction,!1);for(var i=0;i<orderListBy.length;i++)orderListBy[i].addEventListener("click",orderList,!1);function init(){updateList()}function updateList(){console.log("list updating..."),xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&(list.innerHTML=this.responseText,$('[data-toggle="tooltip"]').tooltip())},xhttp.open("GET","roles-handler.php?action=updateList&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc,!0),xhttp.send()}function add(){console.log("adding...");var e=codeInput.value,t=roleInput.value;xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&("emptyFields"==this.responseText?showStatusModal("one ore more fields are empty!","alert alert-danger"):"alreadyExist"==this.responseText?showStatusModal("Already Exist","alert alert-warning"):"queryError"==this.responseText?showStatusModal("Query Error!","alert alert-danger"):(list.innerHTML=this.responseText,codeInput.value=roleInput.value="",showStatusModal("Successfully Added!","alert alert-success")))},xhttp.open("POST","roles-handler.php",!0),xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhttp.send("action=add&codeInputValue="+e+"&roleInputValue="+t+"&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc)}function listBtnFunction(e){var t=(rowEl=e.target.closest("tr")).dataset.id,r=e.target.dataset.action;if("delete"==r)console.log("deleting...",t),xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&("queryError"==this.responseText?showStatusModal("Query Error!","alert alert-danger"):"cantDelete"==this.responseText?showStatusModal("Can't Delete default Category!","alert alert-danger"):"isUsedAtOtherPlace"==this.responseText?showStatusModal("Can't Delete, Role is in Used!","alert alert-danger"):(list.innerHTML=this.responseText,showStatusModal("Successfully Deleted!","alert alert-success")))},confirm("Want to delete?")?(xhttp.open("POST","roles-handler.php",!0),xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhttp.send("action=delete&id="+t+"&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc)):console.log("Deletion is stopped!");else if("edit"==r){console.log("editing...",t);var l=document.querySelector("#list tr.editing");l&&(roleEl.innerHTML=roleElValue,codeEl.innerHTML=codeElValue,l.classList.remove("editing")),roleEl=rowEl.querySelector('[data-column="role"]'),codeEl=rowEl.querySelector('[data-column="code"]'),roleElValue=roleEl.innerHTML,codeElValue=codeEl.innerHTML,rowEl.classList.add("editing"),roleEl.innerHTML='<input type="text" class="form-control"  value="'+roleElValue+'">',codeEl.innerHTML='<input type="text" class="form-control"  value="'+codeElValue+'">',roleEl.querySelector("input").focus();var o=roleEl.querySelector("input"),n=codeEl.querySelector("input"),a=rowEl.querySelector('[data-action="cancel"'),s=rowEl.querySelector('[data-action="submit"');o.addEventListener("keyup",function(e){keyUpFunc(e,a,s)}),n.addEventListener("keyup",function(e){keyUpFunc(e,a,s)})}else if("cancel"==r)console.log("canceling...",t),roleEl.innerHTML=roleElValue,codeEl.innerHTML=codeElValue,rowEl.classList.remove("editing");else if("submit"==r){console.log("submiting...",t);var d=roleEl.querySelector("input").value,i=codeEl.querySelector("input").value;""==d||""==i?showStatusModal("one ore more fields are empty!","alert alert-danger"):d==roleElValue&&i==codeElValue?(roleEl.innerHTML=d,codeEl.innerHTML=i,rowEl.classList.remove("editing"),showStatusModal("Nothing changed!","alert alert-warning")):(xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&("queryError"==this.responseText?showStatusModal("Query Error!","alert alert-danger"):(list.innerHTML=this.responseText,showStatusModal("Successfully Updated!","alert alert-success")))},xhttp.open("POST","roles-handler.php",!0),xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhttp.send("action=submit&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc+"&roleInputValue="+d+"&codeInputValue="+i+"&id="+t))}}init();
//# sourceMappingURL=../../maps/roles.min.js.map

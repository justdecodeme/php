var list=document.getElementById("list"),addBtn=document.getElementById("addBtn"),orderListBy=document.querySelectorAll("[data-order-by]"),statusModalBtn=document.getElementById("statusModalBtn"),statusModalAlert=document.getElementById("statusModalAlert"),borrowerSelect=document.getElementById("borrowerSelect"),bookCategorySelect=document.getElementById("bookCategorySelect"),bookSelect=document.getElementById("bookSelect"),approvedBySelect=document.getElementById("approvedBySelect"),ConfirmedBySelect=document.getElementById("ConfirmedBySelect"),issueDateInput=document.getElementById("issueDateInput"),dueDateInput=document.getElementById("dueDateInput"),returnedDateInput=document.getElementById("returnedDateInput"),orderBy="book_title",ascOrDesc="ASC";const numberOfDaysToAdd=7;addBtn.addEventListener("click",add,!1),bookCategorySelect.addEventListener("change",fetchBookssList,!1),list.addEventListener("click",listBtnFunction,!1);for(var i=0;i<orderListBy.length;i++)orderListBy[i].addEventListener("click",orderList,!1);function init(){fetchBorrowersList(),fetchAdminsList(),fetchBookCategoriesList(),fetchBookssList(),fetchDates()}function fetchBorrowersList(){console.log("fetching borrowers list..."),xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&(borrowerSelect.innerHTML=this.responseText)},xhttp.open("GET","handler.php?action=fetchBorrowersList",!0),xhttp.send()}function fetchAdminsList(){console.log("fetching admins list..."),xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&(approvedBySelect.innerHTML=ConfirmedBySelect.innerHTML=this.responseText)},xhttp.open("GET","handler.php?action=fetchAdminsList",!0),xhttp.send()}function fetchBookCategoriesList(){console.log("fetching book categories list..."),xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&(bookCategorySelect.innerHTML=this.responseText)},xhttp.open("GET","handler.php?action=fetchBookCategoriesList",!0),xhttp.send()}function fetchBookssList(t){var e="";t&&(e=t.target.value),console.log("fetching books list..."),xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&("NA"==this.responseText?(bookSelect.innerHTML="<option>None</option>",bookSelect.setAttribute("disabled","true")):(bookSelect.innerHTML=this.responseText,bookSelect.removeAttribute("disabled")),console.log(this.responseText))},xhttp.open("GET","handler.php?action=fetchBookssList&book_category_id="+e,!0),xhttp.send()}function fetchDates(){console.log("fetching dates..."),issueDateInput.value=getTodaysDate(),dueDateInput.value=returnedDateInput.value=getDateAfterDays(numberOfDaysToAdd)}function updateList(){console.log("list updating..."),xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&(list.innerHTML=this.responseText,$('[data-toggle="tooltip"]').tooltip())},xhttp.open("GET","books-handler.php?action=updateList&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc,!0),xhttp.send()}function add(){console.log("adding...");var t=titleInput.value,e=authorInput.value,o=stockInput.value,n=categoryInput.value;xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&("emptyFields"==this.responseText?showStatusModal("one ore more fields are empty!","alert alert-danger"):"alreadyExist"==this.responseText?showStatusModal("Already Exist","alert alert-warning"):"queryError"==this.responseText?showStatusModal("Query Error!","alert alert-danger"):(list.innerHTML=this.responseText,titleInput.value=authorInput.value=stockInput.value="",showStatusModal("Successfully Added!","alert alert-success")))},xhttp.open("POST","books-handler.php",!0),xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhttp.send("action=add&titleInputValue="+t+"&authorInputValue="+e+"&stockInputValue="+o+"&categoryInputValue="+n+"&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc)}var rowEl,titleEl,titleElValue,authorEl,authorElValue,stockEl,stockElValue,categoryEl,categoryElValue,categoryId;function listBtnFunction(t){var e=(rowEl=t.target.closest("tr")).dataset.id,o=t.target.dataset.action;if("delete"==o)console.log("deleting...",e),xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&("queryError"==this.responseText?showStatusModal("Query Error!","alert alert-danger"):(list.innerHTML=this.responseText,showStatusModal("Successfully Deleted!","alert alert-success")))},confirm("Want to delete?")?(xhttp.open("POST","books-handler.php",!0),xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhttp.send("action=delete&id="+e+"&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc)):console.log("Deletion is stopped!");else if("edit"==o){console.log("editing...",e);var n=document.querySelector("#list tr.editing");n&&(titleEl.innerHTML=titleElValue,authorEl.innerHTML=authorElValue,stockEl.innerHTML=stockElValue,categoryEl.innerHTML=categoryElValue,n.classList.remove("editing")),titleEl=rowEl.querySelector('[data-column="title"]'),authorEl=rowEl.querySelector('[data-column="author"]'),stockEl=rowEl.querySelector('[data-column="stock"]'),categoryEl=rowEl.querySelector('[data-column="category"]'),categoryId=categoryEl.dataset.id,titleElValue=titleEl.innerHTML,authorElValue=authorEl.innerHTML,stockElValue=stockEl.innerHTML,categoryElValue=categoryEl.innerHTML,rowEl.classList.add("editing"),titleEl.innerHTML='<input type="text" class="form-control"  value="'+titleElValue+'">',authorEl.innerHTML='<input type="text" class="form-control"  value="'+authorElValue+'">',stockEl.innerHTML='<input type="number" class="form-control"  value="'+stockElValue+'">',titleEl.querySelector("input").focus(),categoryEl.innerHTML="";var r=categoryInput.cloneNode(!0);categoryEl.appendChild(r),categoryEl.querySelector("select").value=categoryId;var a=titleEl.querySelector("input"),l=authorEl.querySelector("input"),s=stockEl.querySelector("input"),i=rowEl.querySelector('[data-action="cancel"'),c=rowEl.querySelector('[data-action="submit"');a.addEventListener("keyup",function(t){keyUpFunc(t,i,c)}),l.addEventListener("keyup",function(t){keyUpFunc(t,i,c)}),s.addEventListener("keyup",function(t){keyUpFunc(t,i,c)})}else if("cancel"==o)console.log("canceling...",e),titleEl.innerHTML=titleElValue,authorEl.innerHTML=authorElValue,stockEl.innerHTML=stockElValue,categoryEl.innerHTML=categoryElValue,rowEl.classList.remove("editing");else if("submit"==o){console.log("submiting...",e);var u=titleEl.querySelector("input").value,d=authorEl.querySelector("input").value,p=stockEl.querySelector("input").value,h=categoryEl.querySelector("select").value;""==u||""==d||""==p?showStatusModal("one ore more fields are empty!","alert alert-danger"):u==titleElValue&&d==authorElValue&&p==stockElValue&&h==categoryId?(titleEl.innerHTML=u,authorEl.innerHTML=d,stockEl.innerHTML=p,categoryEl.innerHTML=categoryElValue,rowEl.classList.remove("editing"),showStatusModal("Nothing changed!","alert alert-warning")):(xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&("queryError"==this.responseText?showStatusModal("Query Error!","alert alert-danger"):(list.innerHTML=this.responseText,showStatusModal("Successfully Updated!","alert alert-success")))},xhttp.open("POST","books-handler.php",!0),xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhttp.send("action=submit&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc+"&titleInputValue="+u+"&authorInputValue="+d+"&stockInputValue="+p+"&categoryInputValue="+h+"&id="+e))}}init();
//# sourceMappingURL=../../maps/library.min.js.map

var rowEl,roleEl,roleElValue,roleCode,list=document.getElementById("list"),orderListBy=document.querySelectorAll("[data-order-by]"),statusModalBtn=document.getElementById("statusModalBtn"),statusModalAlert=document.getElementById("statusModalAlert"),roleSelect=document.getElementById("roleSelect"),genderSelect=document.getElementById("genderSelect"),searchSelect=document.getElementById("searchSelect"),orderBy="user_name",ascOrDesc="ASC";roleSelect.addEventListener("change",updateList,!1),genderSelect.addEventListener("change",updateList,!1),searchSelect.addEventListener("keyup",updateList,!1),list.addEventListener("click",listBtnFunction,!1);for(var i=0;i<orderListBy.length;i++)orderListBy[i].addEventListener("click",orderList,!1);function init(){document.querySelector('[data-order-by="'+orderBy+'"]').classList.add("active-ASC"),fetchRolesForUsers(),updateList()}function fetchRolesForUsers(){console.log("fetching roles for users list..."),xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&(roleSelect.innerHTML=this.responseText)},xhttp.open("GET","handler.php?action=fetchRolesForUsers",!0),xhttp.send()}function updateList(){console.log("list updating..."),roleValue=roleSelect.value,genderValue=genderSelect.value,searchValue=searchSelect.value,xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&(list.innerHTML=this.responseText,totalInput.value=list.getElementsByTagName("tr").length)},xhttp.open("GET","handler.php?action=updateList&roleValue="+roleValue+"&genderValue="+genderValue+"&searchValue="+searchValue+"&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc,!0),xhttp.send()}function listBtnFunction(e){var t=(rowEl=e.target.closest("tr")).dataset.id,r=e.target.dataset.action;if("delete"==r)console.log("deleting...",t),xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&("queryError"==this.responseText?showStatusModal("Query Error!","alert alert-danger"):(list.innerHTML=this.responseText,showStatusModal("Successfully Deleted!","alert alert-success")))},confirm("Want to delete?")?(xhttp.open("POST","handler.php",!0),xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhttp.send("action=delete&id="+t+"&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc)):console.log("Deletion is stopped!");else if("edit"==r){console.log("editing...",t);var l=document.querySelector("#list tr.editing");l&&(roleEl.innerHTML=roleElValue,l.classList.remove("editing")),roleEl=rowEl.querySelector('[data-column="role"]'),roleCode=roleEl.dataset.code,roleElValue=roleEl.innerHTML,rowEl.classList.add("editing"),roleEl.innerHTML="";var o=roleSelect.cloneNode(!0);roleEl.appendChild(o),roleEl.querySelector("select option:first-child").remove(),roleEl.querySelector("select").value=roleCode,roleEl.querySelector("select").focus();var s=roleEl.querySelector("select"),a=rowEl.querySelector('[data-action="cancel"'),n=rowEl.querySelector('[data-action="submit"');s.addEventListener("keyup",function(e){e.preventDefault(),keyUpFunc(e,a,n)})}else if("cancel"==r)console.log("canceling...",t),roleEl.innerHTML=roleElValue,rowEl.classList.remove("editing");else if("submit"==r){console.log("submiting...",t);var c=roleEl.querySelector("select").value;""==c?showStatusModal("one ore more fields are empty!","alert alert-danger"):c==roleElValue?(roleEl.innerHTML=roleElValue,rowEl.classList.remove("editing"),showStatusModal("Nothing changed!","alert alert-warning")):(xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&("queryError"==this.responseText?showStatusModal("Query Error!","alert alert-danger"):(list.innerHTML=this.responseText,showStatusModal("Successfully Updated!","alert alert-success")))},xhttp.open("POST","handler.php",!0),xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhttp.send("action=submit&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc+"&roleInputValue="+c+"&id="+t))}}init();
//# sourceMappingURL=../../maps/users.min.js.map

{"version":3,"sources":["timetable.js"],"names":["timetableOuter","document","getElementById","selectedDateOuter","selectedBatchOuter","orderByItems","querySelectorAll","filterStartDate","filterEndDate","selectedBatch","selectedLayout","addClassBtn","timetableResultList","timetableResultGrid_A","timetableResultGrid_B","refreshBtn","selectedClassEl","selectedInstructorEL","selectedRoomEL","editingClassFlag","batchCode","batchTemplate","layout","orderBy","ascOrDesc","fetchBatchList","console","log","xhttp0","XMLHttpRequest","onreadystatechange","this","readyState","status","innerHTML","responseText","updateTimeTableList","updateTimeTableGrid","open","send","value","querySelector","dataset","template","classesObj","batchData","classesList","classCode","instructorsObj","instructorsList","instructorCode","roomsObj","roomsList","roomCode","xhttp1","xhttp2a","xhttp2b","addClass","date","startTime","endTime","xhttp3","setRequestHeader","individualClassEdit","e","stopPropagation","target","id","cancelClassId","classId","submitClassId","xhttp5","editClassId","elementEditing","elementEditingDate","elementEditingClass","elementEditingInstructor","elementEditingTime","elementEditingRoom","classList","add","starttime","endtime","class","instructor","room","deleteCalssId","xhttp4","confirm","updateLayout","remove","orderClassBy","prevOrderBy","i","length","init","selectedDate","currentDate","addEventListener"],"mappings":"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","sourcesContent":["/****************Variables****************/\n\nvar timetableOuter = document.getElementById('timetableOuter');\nvar selectedDateOuter = document.getElementById('selectedDateOuter');\nvar selectedBatchOuter = document.getElementById('selectedBatchOuter');\nvar orderByItems = document.querySelectorAll('[data-order-by]');\nvar filterStartDate = document.getElementById('filterStartDate');\nvar filterEndDate = document.getElementById('filterEndDate');\n\nvar selectedBatch = document.getElementById('selectedBatch');\nvar selectedLayout = document.getElementById('selectedLayout');\n\nvar addClassBtn = document.getElementById('addClassBtn');\n\nvar timetableResultList = document.getElementById('timetableResultList');\nvar timetableResultGrid_A = document.getElementById('timetableResultGrid_A');\nvar timetableResultGrid_B = document.getElementById('timetableResultGrid_B');\nvar refreshBtn = document.getElementById('refreshBtn');\n\nvar selectedClassEl = document.getElementById('selectedClass');\nvar selectedInstructorEL = document.getElementById('selectedInstructor');\nvar selectedRoomEL = document.getElementById('selectedRoom');\n\nvar editingClassFlag = false;\nvar batchCode = null;\nvar batchTemplate = null;\nvar layout = 'list';\nvar orderBy = 'class_date';\nvar ascOrDesc = 'ASC';\n\n/****************Functions****************/\n\n// fetch the batch list to make drop down\nfunction fetchBatchList() {\n  console.log('fetching batch list...');\n  // load content from database\n  var xhttp0 = new XMLHttpRequest();\n  xhttp0.onreadystatechange = function() {\n    if (this.readyState == 4 && this.status == 200) {\n     selectedBatch.innerHTML = this.responseText;\n     updateTimeTableList(selectedBatch);\n     updateTimeTableGrid();\n   } else {\n     // console.log(this.readyState, this.status);\n   }\n  };\n  xhttp0.open(\"GET\", \"batch_handler.php?action=fetchBatchList\", true);  // open(method, url, async)\n  xhttp0.send();\n}\n\n// Update time table on change of batch\nfunction updateTimeTableList() {\n  console.log('timetable list updating...');\n\n  editingClassFlag = false;\n\n  // check which batch is selected in dropdown\n  batchCode = selectedBatch.value;\n\n  // check which batch template needs to be used\n  batchTemplate = document.querySelector(\"[value='\"+batchCode+\"']\").dataset.template;\n\n  // load classses from json, based on batch template selected\n  var classesObj = batchData[batchTemplate]['classes'];\n  var classesList = '';\n\n  for (var classCode in classesObj) {\n    classesList += '<option value=\"'+classCode+'\">'+classesObj[classCode]+'</option>';\n  }\n  selectedClassEl.innerHTML = classesList;\n\n  // load instructors from json, based on batch template selected\n  var instructorsObj = batchData[batchTemplate]['instructors'];\n  var instructorsList = '';\n\n  for (var instructorCode in instructorsObj) {\n    instructorsList += '<option value=\"'+instructorCode+'\">'+instructorsObj[instructorCode]+'</option>';\n  }\n  selectedInstructorEL.innerHTML = instructorsList;\n\n  // load rooms from json, based on batch template selected\n  var roomsObj = batchData[batchTemplate]['rooms'];\n  var roomsList = '';\n\n  for (var roomCode in roomsObj) {\n    roomsList += '<option value=\"'+roomCode+'\">'+roomsObj[roomCode]+'</option>';\n  }\n  selectedRoomEL.innerHTML = roomsList;\n\n  // load content from database\n  var xhttp1 = new XMLHttpRequest();\n  xhttp1.onreadystatechange = function() {\n    if (this.readyState == 4 && this.status == 200) {\n     timetableResultList.innerHTML = this.responseText;\n   } else {\n     // console.log(this.readyState, this.status);\n   }\n  };\n  xhttp1.open(\"GET\", \"timetable_handler.php?action=updateTimeTableList\"+\n    \"&batchCode=\"+batchCode+\n    \"&batchTemplate=\"+batchTemplate+\n    \"&orderBy=\"+orderBy+\n    \"&ascOrDesc=\"+ascOrDesc\n  , true);  // open(method, url, async)\n  xhttp1.send();\n}\n\n// Update time table on change of batch\nfunction updateTimeTableGrid() {\n  console.log('timetable grid updating...');\n  var filterStartDate = document.getElementById('filterStartDate').value;\n  var filterEndDate = document.getElementById('filterEndDate').value;\n\n  // load content from database\n  var xhttp2a = new XMLHttpRequest();\n  xhttp2a.onreadystatechange = function() {\n    if (this.readyState == 4 && this.status == 200) {\n     timetableResultGrid_A.innerHTML = this.responseText;\n   } else {\n     // console.log(this.readyState, this.status);\n   }\n  };\n  xhttp2a.open(\"GET\", \"timetable_handler.php?action=updateTimeTableGrid_A&filterStartDate=\"+filterStartDate+\"&filterEndDate=\"+filterEndDate, true);  // open(method, url, async)\n  xhttp2a.send();\n\n  // load content from database\n  var xhttp2b = new XMLHttpRequest();\n  xhttp2b.onreadystatechange = function() {\n    if (this.readyState == 4 && this.status == 200) {\n     timetableResultGrid_B.innerHTML = this.responseText;\n   } else {\n     // console.log(this.readyState, this.status);\n   }\n  };\n  xhttp2b.open(\"GET\", \"timetable_handler.php?action=updateTimeTableGrid_B&filterStartDate=\"+filterStartDate+\"&filterEndDate=\"+filterEndDate, true);  // open(method, url, async)\n  xhttp2b.send();\n}\n\n// Add class on Submit btn click\nfunction addClass() {\n  if(!editingClassFlag) {\n    console.log('adding class..');\n    console.log('updating batch dates..');\n\n    var date = document.getElementById('selectedDate').value;\n    var classCode = document.getElementById('selectedClass').value;\n    var instructorCode = document.getElementById('selectedInstructor').value;\n    var startTime = document.getElementById('selectedStartTime').value;\n    var endTime = document.getElementById('selectedEndTime').value;\n    var roomCode = document.getElementById('selectedRoom').value;\n    // console.log(batchCode, batchTemplate, date, classCode, instructorCode, startTime, endTime, roomCode);\n\n    var xhttp3 = new XMLHttpRequest();\n    xhttp3.onreadystatechange = function() {\n      if (this.readyState == 4 && this.status == 200) {\n        timetableResultList.innerHTML = this.responseText;\n      } else {\n        // console.log(this.readyState, this.status);\n      }\n    };\n    xhttp3.open(\"POST\", \"timetable_handler.php\", true);  // open(method, url, async)\n    xhttp3.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n    xhttp3.send(\"action=addClass\"+\n      \"&batchCode=\"+batchCode+\n      \"&batchTemplate=\"+batchTemplate+\n      \"&orderBy=\"+orderBy+\n      \"&ascOrDesc=\"+ascOrDesc+\n      \"&date=\"+date+\n      \"&classCode=\"+classCode+\n      \"&instructorCode=\"+instructorCode+\n      \"&startTime=\"+startTime+\n      \"&endTime=\"+endTime+\n      \"&roomCode=\"+roomCode\n    );\n  }\n}\n\n// Edit -> Delete -> Cancel -> Submit class fuctions\nfunction individualClassEdit(e) {\n  e.stopPropagation();\n  // delete class -> only if not editing any class\n  if(e.target.id == 'deleteClass' && !editingClassFlag) {\n    var deleteCalssId = e.target.dataset.classId;\n    console.log('deleting: ' + deleteCalssId);\n\n    var xhttp4 = new XMLHttpRequest();\n    xhttp4.onreadystatechange = function() {\n      if (this.readyState == 4 && this.status == 200) {\n       timetableResultList.innerHTML = this.responseText;\n     } else {\n       // console.log(this.readyState, this.status);\n     }\n    };\n\n    var deleteConfirmation = confirm(\"Want to delete?\");\n    if (deleteConfirmation) {\n        //Logic to delete the item\n        xhttp4.open(\"POST\", \"timetable_handler.php\", true);  // open(method, url, async)\n        xhttp4.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n        xhttp4.send(\"action=deleteClass&batchCode=\"+batchCode+\"&batchTemplate=\"+batchTemplate+\"&orderBy=\"+orderBy+\"&ascOrDesc=\"+ascOrDesc+\"&deleteId=\"+deleteCalssId);\n    } else {\n      console.log('Deletion is stopped!');\n    }\n  }\n  // edit class -> only if not editing any class\n  else if(e.target.id == 'editClass' && !editingClassFlag) {\n    var editClassId = e.target.dataset.classId;\n    console.log('editing: ' + editClassId);\n\n    editingClassFlag = true;\n\n    var elementEditing = document.getElementById('editClass_'+editClassId);\n    var elementEditingDate = elementEditing.querySelector('.edit-date');\n    var elementEditingClass = elementEditing.querySelector('.edit-class');\n    var elementEditingInstructor = elementEditing.querySelector('.edit-instructor');\n    var elementEditingTime = elementEditing.querySelector('.edit-time');\n    var elementEditingRoom = elementEditing.querySelector('.edit-room');\n\n    elementEditing.classList.add('editing-class');\n    elementEditingDate.innerHTML = '<input type=\"date\" class=\"form-control\" id=\"editingDate\" value=\"'+elementEditingDate.dataset.date+'\">';\n    elementEditingTime.classList.add('time-picker');\n    elementEditingTime.innerHTML = '<input type=\"time\" class=\"form-control\" id=\"editingStartTime\" value=\"'+elementEditingTime.dataset.starttime+'\"><input type=\"time\" class=\"form-control\" id=\"editingEndTime\" value=\"'+elementEditingTime.dataset.endtime+'\">';\n\n    // load classses from json, based on batch template selected\n    var classesObj = batchData[batchTemplate]['classes'];\n    var classesList = '';\n    for (var classCode in classesObj) {\n      if(classCode == elementEditingClass.dataset.class) {\n        classesList += '<option value=\"'+classCode+'\" selected>'+classesObj[classCode]+'</option>';\n      } else {\n        classesList += '<option value=\"'+classCode+'\">'+classesObj[classCode]+'</option>';\n      }\n    }\n    elementEditingClass.innerHTML = '<select class=\"custom-select\" id=\"editingClass\">'+classesList+'</select>';;\n\n    // load instructors from json, based on batch template selected\n    var instructorsObj = batchData[batchTemplate]['instructors'];\n    var instructorsList = '';\n\n    for (var instructorCode in instructorsObj) {\n      if(instructorCode == elementEditingInstructor.dataset.instructor) {\n        instructorsList += '<option value=\"'+instructorCode+'\" selected>'+instructorsObj[instructorCode]+'</option>';\n      } else {\n        instructorsList += '<option value=\"'+instructorCode+'\">'+instructorsObj[instructorCode]+'</option>';\n      }\n    }\n    elementEditingInstructor.innerHTML = '<select class=\"custom-select\" id=\"editingInstructors\">'+instructorsList+'</select>';;\n\n    // load rooms from json, based on batch template selected\n    var roomsObj = batchData[batchTemplate]['rooms'];\n    var roomsList = '';\n\n    for (var roomCode in roomsObj) {\n      if(roomCode == elementEditingRoom.dataset.room) {\n        roomsList += '<option value=\"'+roomCode+'\" selected>'+roomsObj[roomCode]+'</option>';\n      } else {\n        roomsList += '<option value=\"'+roomCode+'\">'+roomsObj[roomCode]+'</option>';\n      }\n    }\n    elementEditingRoom.innerHTML = '<select class=\"custom-select\" id=\"editingRoom\">'+roomsList+'</select>';\n  }\n  // cancel class -> if editing any class\n  else if(e.target.id == 'cancelClass' && editingClassFlag) {\n    var cancelClassId = e.target.dataset.classId;\n    console.log('cancelling: ' + cancelClassId);\n\n    updateTimeTableList();\n  }\n  // submit class -> if editing any class\n  else if(e.target.id == 'submitClass' && editingClassFlag) {\n    var submitClassId = e.target.dataset.classId;\n    console.log('submitting: ' + submitClassId);\n\n    var date = document.getElementById('editingDate').value;\n    var classCode = document.getElementById('editingClass').value;\n    var instructorCode = document.getElementById('editingInstructors').value;\n    var startTime = document.getElementById('editingStartTime').value;\n    var endTime = document.getElementById('editingEndTime').value;\n    var roomCode = document.getElementById('editingRoom').value;\n    // console.log(batchCode, batchTemplate, date, classCode, instructorCode, startTime, endTime, roomCode);\n\n    var xhttp5 = new XMLHttpRequest();\n    xhttp5.onreadystatechange = function() {\n      if (this.readyState == 4 && this.status == 200) {\n        timetableResultList.innerHTML = this.responseText;\n        editingClassFlag = false;\n      }\n    };\n    xhttp5.open(\"POST\", \"timetable_handler.php\", true);  // open(method, url, async)\n    xhttp5.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n    xhttp5.send(\"action=submitClass&batchCode=\"+batchCode+\"&batchTemplate=\"+batchTemplate+\"&orderBy=\"+orderBy+\n    \"&ascOrDesc=\"+ascOrDesc+\"&date=\"+date+\"&classCode=\"+classCode+\"&instructorCode=\"+instructorCode+\n    \"&startTime=\"+startTime+\"&endTime=\"+endTime+\"&roomCode=\"+roomCode+\"&submitId=\"+submitClassId);\n\n    // updateTimeTableList();\n  }\n}\n\n// Update layout on change of list or grid\nfunction updateLayout(e) {\n  if(e.target) {\n    layout = e.target.value;\n  } else {\n    layout = selectedLayout.value;\n  }\n  if(layout == 'list') {\n    timetableOuter.classList.add('list');\n    timetableOuter.classList.remove('grid');\n  } else {\n    timetableOuter.classList.add('grid');\n    timetableOuter.classList.remove('list');\n  }\n}\n\n// function to order tables on click\nfunction orderClassBy(e) {\n  var prevOrderBy = orderBy;\n\n  // remove active class from all columns\n  for(var i = 0; i < orderByItems.length; i++) {\n    orderByItems[i].classList.remove('active-ASC');\n    orderByItems[i].classList.remove('active-DESC');\n  }\n\n  orderBy = e.target.dataset.orderBy;\n\n  // toggle ASC | DESC if column clicked is same as previous click\n  if(prevOrderBy == orderBy) {\n    if(ascOrDesc == 'DESC') {\n      ascOrDesc = 'ASC';\n    } else {\n      ascOrDesc = 'DESC';\n    }\n    // make ASC if column clicked is different from previous click\n  } else {\n    ascOrDesc = 'ASC';\n  }\n\n  // add active class to clicked column\n  e.target.classList.add('active-'+ascOrDesc);\n\n  console.log('ordering by...' + orderBy, ascOrDesc);\n\n  updateTimeTableList();\n}\n\n// run on page laod\nfunction init() {\n  selectedDate.value = currentDate();\n  // filterStartDate.value = currentDate();\n  filterStartDate.value = \"2018-04-09\";\n  filterEndDate.value = \"2018-05-20\";\n  fetchBatchList();\n  updateLayout(selectedLayout);\n};\ninit();\n\n/****************Events****************/\n\nselectedBatch.addEventListener('change', updateTimeTableList, false);\nfilterStartDate.addEventListener('change', updateTimeTableGrid, false);\nfilterEndDate.addEventListener('change', updateTimeTableGrid, false);\nselectedLayout.addEventListener('change', updateLayout, false);\nrefreshBtn.addEventListener('click', init, false);\naddClassBtn.addEventListener('click', addClass, false);\ntimetableResultList.addEventListener('click', individualClassEdit, false);\nfor(var i = 0; i < orderByItems.length; i++) {\n  orderByItems[i].addEventListener('click', orderClassBy, false);\n}\n"],"file":"timetable.min.js"}
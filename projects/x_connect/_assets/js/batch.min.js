var selectedDateOuter=document.getElementById("selectedDateOuter"),orderByItems=document.querySelectorAll("[data-order-by]"),selectedBatchCode=document.getElementById("selectedBatchCode"),selectedBatchName=document.getElementById("selectedBatchName"),selectedBatchStartDate=document.getElementById("selectedBatchStartDate"),selectedBatchEndDate=document.getElementById("selectedBatchEndDate"),addBatchBtn=document.getElementById("addBatchBtn"),timetableBatchList=document.getElementById("timetableBatchList"),editingBatchFlag=!1,orderBy="batch_name",ascOrDesc="ASC";function updateBatchList(){console.log("batch list updating..."),editingBatchFlag=!1;var t=new XMLHttpRequest;t.onreadystatechange=function(){4==this.readyState&&200==this.status&&(timetableBatchList.innerHTML=this.responseText,selectedBatchCode.value=selectedBatchName.value="")},t.open("GET","batch_handler.php?action=updateBatchList&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc,!0),t.send()}function addBatch(){if(!editingBatchFlag){console.log("adding batch...");var t=selectedBatchCode.value,e=selectedBatchName.value,a=currentDate(),d=currentDate(),c=new XMLHttpRequest;c.onreadystatechange=function(){4==this.readyState&&200==this.status&&updateBatchList()},c.open("POST","batch_handler.php",!0),c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.send("action=addBatch&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc+"&batchCode="+t+"&batchName="+e+"&batchStartDate="+a+"&batchEndDate="+d)}}function individualBatchEdit(t){if(t.stopPropagation(),"deleteBatch"!=t.target.id||editingBatchFlag)if("editBatch"!=t.target.id||editingBatchFlag){if("cancelBatch"==t.target.id&&editingBatchFlag){var e=t.target.dataset.batchId;console.log("cancelling: "+e),updateBatchList()}else if("submitBatch"==t.target.id&&editingBatchFlag){var a=t.target.dataset.batchId;console.log("submitting: "+a);var d=document.getElementById("editingCode").value,c=document.getElementById("editingName").value,n=document.getElementById("editingStartDate").value,i=document.getElementById("editingEndDate").value,s=document.getElementById("editingStudents").value,r=new XMLHttpRequest;r.onreadystatechange=function(){4==this.readyState&&200==this.status&&(updateBatchList(),editingBatchFlag=!1)},r.open("POST","batch_handler.php",!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.send("action=submitBatch&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc+"&batchCode="+d+"&batchName="+c+"&batchStartDate="+n+"&batchEndDate="+i+"&batchStuents="+s+"&submitId="+a)}}else{var o=t.target.dataset.batchId;console.log("editing: "+o),editingBatchFlag=!0;var l=document.getElementById("editBatch_"+o),h=l.querySelector(".edit-batch-code"),u=l.querySelector(".edit-batch-name"),B=l.querySelector(".edit-batch-start-date"),g=l.querySelector(".edit-batch-end-date"),m=l.querySelector(".edit-batch-students");l.classList.add("editing-class"),h.innerHTML='<input type="text" class="form-control" id="editingCode" value="'+h.dataset.batchCode+'">',u.innerHTML='<input type="text" class="form-control" id="editingName" value="'+u.dataset.batchName+'">',B.innerHTML='<input type="date" class="form-control" id="editingStartDate" value="'+B.dataset.batchStartDate+'">',g.innerHTML='<input type="date" class="form-control" id="editingEndDate" value="'+g.dataset.batchEndDate+'">',m.innerHTML='<input type="number" class="form-control" id="editingStudents" value="'+m.dataset.batchStudents+'">'}else{var y=t.target.dataset.batchId;console.log("deleting: "+y);var p=new XMLHttpRequest;p.onreadystatechange=function(){4==this.readyState&&200==this.status&&updateBatchList()},confirm("Want to delete?")?(p.open("POST","batch_handler.php",!0),p.setRequestHeader("Content-type","application/x-www-form-urlencoded"),p.send("action=deleteBatch&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc+"&deleteId="+y)):console.log("Deletion is stopped!")}}function orderClassBy(t){for(var e=orderBy,a=0;a<orderByItems.length;a++)orderByItems[a].classList.remove("active-ASC"),orderByItems[a].classList.remove("active-DESC");orderBy=t.target.dataset.orderBy,ascOrDesc=e==orderBy?"DESC"==ascOrDesc?"ASC":"DESC":"ASC",t.target.classList.add("active-"+ascOrDesc),console.log("ordering by..."+orderBy,ascOrDesc),updateBatchList()}function init(){updateBatchList()}init(),addBatchBtn.addEventListener("click",addBatch,!1),timetableBatchList.addEventListener("click",individualBatchEdit,!1);for(var i=0;i<orderByItems.length;i++)orderByItems[i].addEventListener("click",orderClassBy,!1);
//# sourceMappingURL=batch.min.js.map

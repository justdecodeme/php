var selectedDateOuter=document.getElementById("selectedDateOuter"),orderByItems=document.querySelectorAll("[data-order-by]"),selectedBatchCode=document.getElementById("selectedBatchCode"),selectedBatchName=document.getElementById("selectedBatchName"),selectedBatchStartDate=document.getElementById("selectedBatchStartDate"),selectedBatchEndDate=document.getElementById("selectedBatchEndDate"),addBatchBtn=document.getElementById("addBatchBtn"),timetableBatchList=document.getElementById("timetableBatchList"),editingBatchFlag=!1,orderBy="batch_name",ascOrDesc="ASC",progressBar=document.getElementById("progressBar"),progressBarInner=progressBar.querySelector(".progress-bar");function updateBatchList(){console.log("batch list updating..."),editingBatchFlag=!1;var e=new XMLHttpRequest;e.onreadystatechange=function(){4==this.readyState&&200==this.status&&setTimeout(()=>{progressBarInner.style.width="0%",timetableBatchList.innerHTML=this.responseText},2e3)},console.log(e),e.open("GET","batch_handler.php?action=updateBatchList&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc,!0),e.send()}function addBatch(){if(!editingBatchFlag){console.log("adding batch...");var e=selectedBatchCode.value,t=selectedBatchName.value,a=currentDate(),c=currentDate(),d=new XMLHttpRequest;d.onreadystatechange=function(){4==this.readyState&&200==this.status&&(timetableBatchList.innerHTML=this.responseText,selectedBatchCode.value=selectedBatchName.value="")},d.open("POST","batch_handler.php",!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.send("action=addBatch&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc+"&batchCode="+e+"&batchName="+t+"&batchStartDate="+a+"&batchEndDate="+c)}}function individualBatchEdit(e){if(e.stopPropagation(),"deleteBatch"!=e.target.id||editingBatchFlag)if("editBatch"!=e.target.id||editingBatchFlag){if("cancelBatch"==e.target.id&&editingBatchFlag){var t=e.target.dataset.batchId;console.log("cancelling: "+t),updateBatchList()}else if("submitBatch"==e.target.id&&editingBatchFlag){var a=e.target.dataset.batchId;console.log("submitting: "+a);var c=document.getElementById("editingCode").value,d=document.getElementById("editingName").value,s=new XMLHttpRequest;s.onreadystatechange=function(){4==this.readyState&&200==this.status&&(timetableBatchList.innerHTML=this.responseText,editingBatchFlag=!1)},s.open("POST","batch_handler.php",!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.send("action=submitBatch&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc+"&batchCode="+c+"&batchName="+d+"&submitId="+a)}}else{var r=e.target.dataset.batchId;console.log("editing: "+r),editingBatchFlag=!0;var n=document.getElementById("editBatch_"+r),i=n.querySelector(".edit-batch-code"),o=n.querySelector(".edit-batch-name");n.classList.add("editing-class"),i.innerHTML='<input type="text" class="form-control" id="editingCode" value="'+i.dataset.batchCode+'">',o.innerHTML='<input type="text" class="form-control" id="editingName" value="'+o.dataset.batchName+'">'}else{var l=e.target.dataset.batchId;console.log("deleting: "+l);var h=new XMLHttpRequest;h.onreadystatechange=function(){4==this.readyState&&200==this.status&&(timetableBatchList.innerHTML=this.responseText)},confirm("Want to delete?")?(h.open("POST","batch_handler.php",!0),h.setRequestHeader("Content-type","application/x-www-form-urlencoded"),h.send("action=deleteBatch&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc+"&deleteId="+l)):console.log("Deletion is stopped!")}}function orderClassBy(e){for(var t=orderBy,a=0;a<orderByItems.length;a++)orderByItems[a].classList.remove("active-ASC"),orderByItems[a].classList.remove("active-DESC");orderBy=e.target.dataset.orderBy,ascOrDesc=t==orderBy?"DESC"==ascOrDesc?"ASC":"DESC":"ASC",e.target.classList.add("active-"+ascOrDesc),console.log("ordering by..."+orderBy,ascOrDesc),updateBatchList()}function init(){updateBatchList()}init(),addBatchBtn.addEventListener("click",addBatch,!1),timetableBatchList.addEventListener("click",individualBatchEdit,!1);for(var i=0;i<orderByItems.length;i++)orderByItems[i].addEventListener("click",orderClassBy,!1);
//# sourceMappingURL=batch.min.js.map

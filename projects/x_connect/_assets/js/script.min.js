var xhttp=new XMLHttpRequest,selectedBatch=document.getElementById("selectedBatch"),addClassBtn=document.getElementById("addClassBtn"),timetableResult=document.getElementById("timetableResult"),batchCode=null,batchTemplate=null,selectedClassEl=document.getElementById("selectedClass"),selectedInstructorEL=document.getElementById("selectedInstructor"),selectedRoomEL=document.getElementById("selectedRoom");function updateTimeTable(e){batchCode=e.target?e.target.value:selectedBatch.value,batchTemplate=document.querySelector("[value='"+batchCode+"']").dataset.template;var t=batch[batchTemplate].classes,a="";for(var l in t)a+='<option value="'+l+'">'+t[l]+"</option>";selectedClassEl.innerHTML=a;var d=batch[batchTemplate].instructors,n="";for(var s in d)n+='<option value="'+s+'">'+d[s]+"</option>";selectedInstructorEL.innerHTML=n;var c=batch[batchTemplate].rooms,o="";for(var m in c)o+='<option value="'+m+'">'+c[m]+"</option>";selectedRoomEL.innerHTML=o,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&(timetableResult.innerHTML=this.responseText)},xhttp.open("GET","handler_timetable.php?action=updateTimeTable&batchCode="+batchCode+"&batchTemplate="+batchTemplate,!0),xhttp.send()}function addClass(){console.log("clicked");var e=document.getElementById("selectedBatch").value,t=document.getElementById("selectedDate").value,a=document.getElementById("selectedClass").value,l=document.getElementById("selectedInstructor").value,d=document.getElementById("selectedStartTime").value,n=document.getElementById("selectedEndTime").value,s=document.getElementById("selectedRoom").value;console.log(e,t,a,l,d,n,s),xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&(timetableResult.innerHTML=this.responseText)},xhttp.open("POST","handler_timetable.php",!0),xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhttp.send("action=addClass&batchCode="+e+"&date="+t+"&classCode="+a+"&instructorCode="+l+"&startTime="+d+"&endTime="+n+"&roomCode="+s)}selectedBatch.addEventListener("change",updateTimeTable,!1),addClassBtn.addEventListener("click",addClass,!1),updateTimeTable(selectedBatch);
{"version":3,"sources":["batch.js"],"names":["selectedDateOuter","document","getElementById","orderByItems","querySelectorAll","addBatchBtn","timetableBatchList","selectedClassEl","selectedInstructorEL","selectedRoomEL","editingBatchFlag","orderBy","ascOrDesc","updateBatchList","console","log","xhttp1","XMLHttpRequest","onreadystatechange","this","readyState","status","innerHTML","responseText","open","send","addBatch","batchCode","value","batchName","batchStartDate","batchEndDate","batchStuents","xhttp2","setRequestHeader","individualBatchEdit","e","stopPropagation","target","id","cancelBatchId","dataset","batchId","submitBatchId","xhttp4","editBatchId","elementEditing","elementEditingCode","querySelector","elementEditingName","elementEditingStartDate","elementEditingEndDate","elementEditingStudents","classList","add","batchStudents","deleteBatchId","xhttp3","confirm","orderClassBy","prevOrderBy","i","length","remove","init","addEventListener"],"mappings":"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","sourcesContent":["/****************Variables****************/\r\n\r\nvar selectedDateOuter = document.getElementById('selectedDateOuter');\r\nvar orderByItems = document.querySelectorAll('[data-order-by]');\r\n\r\nvar addBatchBtn = document.getElementById('addBatchBtn');\r\n\r\nvar timetableBatchList = document.getElementById('timetableBatchList');\r\n\r\nvar selectedClassEl = document.getElementById('selectedClass');\r\nvar selectedInstructorEL = document.getElementById('selectedInstructor');\r\nvar selectedRoomEL = document.getElementById('selectedRoom');\r\n\r\nvar editingBatchFlag = false;\r\nvar orderBy = 'batch_name';\r\nvar ascOrDesc = 'ASC';\r\n\r\n/****************Functions****************/\r\n\r\n// Update time table on change of batch\r\nfunction updateBatchList() {\r\n  console.log('batch list updating...');\r\n\r\n  editingBatchFlag = false;\r\n\r\n  // load content from database\r\n  var xhttp1 = new XMLHttpRequest();\r\n  xhttp1.onreadystatechange = function() {\r\n    if (this.readyState == 4 && this.status == 200) {\r\n     timetableBatchList.innerHTML = this.responseText;\r\n   } else {\r\n     // console.log(this.readyState, this.status);\r\n   }\r\n  };\r\n  xhttp1.open(\"GET\", \"batch_handler.php?action=updateBatchList&orderBy=\"+orderBy+\"&ascOrDesc=\"+ascOrDesc, true);  // open(method, url, async)\r\n  xhttp1.send();\r\n}\r\n\r\n// Add class on Submit btn click\r\nfunction addBatch() {\r\n  if(!editingBatchFlag) {\r\n    console.log('adding');\r\n\r\n    var batchCode = document.getElementById('selectedBatchCode').value;\r\n    var batchName = document.getElementById('selectedBatchName').value;\r\n    var batchStartDate = document.getElementById('selectedBatchStartDate').value;\r\n    var batchEndDate = document.getElementById('selectedBatchEndDate').value;\r\n    var batchStuents = document.getElementById('selectedBatchStuents').value;\r\n    // console.log(batchCode, batchName, batchStartDate, batchEndDate, batchStuents);\r\n\r\n    var xhttp2 = new XMLHttpRequest();\r\n    xhttp2.onreadystatechange = function() {\r\n      if (this.readyState == 4 && this.status == 200) {\r\n        timetableBatchList.innerHTML = this.responseText;\r\n      }\r\n    };\r\n    xhttp2.open(\"POST\", \"batch_handler.php\", true);  // open(method, url, async)\r\n    xhttp2.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n    xhttp2.send(\"action=addBatch&orderBy=\"+orderBy+\"&ascOrDesc=\"+ascOrDesc+\"&batchCode=\"+batchCode+\r\n    \"&batchName=\"+batchName+\"&batchStartDate=\"+batchStartDate+\"&batchEndDate=\"+batchEndDate+\r\n    \"&batchStuents=\"+batchStuents);\r\n  }\r\n}\r\n\r\n// Edit -> Delete -> Cancel -> Submit class fuctions\r\nfunction individualBatchEdit(e) {\r\n  e.stopPropagation();\r\n  // delete batch -> only if not editing any batch\r\n  if(e.target.id == 'deleteBatch' && !editingBatchFlag) {\r\n    var deleteBatchId = e.target.dataset.batchId;\r\n    console.log('deleting: ' + deleteBatchId);\r\n\r\n    var xhttp3 = new XMLHttpRequest();\r\n    xhttp3.onreadystatechange = function() {\r\n      if (this.readyState == 4 && this.status == 200) {\r\n       timetableBatchList.innerHTML = this.responseText;\r\n      }\r\n    };\r\n\r\n    var deleteConfirmation = confirm(\"Want to delete?\");\r\n    if (deleteConfirmation) {\r\n        //Logic to delete the item\r\n        xhttp3.open(\"POST\", \"batch_handler.php\", true);  // open(method, url, async)\r\n        xhttp3.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n        xhttp3.send(\"action=deleteBatch&orderBy=\"+orderBy+\"&ascOrDesc=\"+ascOrDesc+\"&deleteId=\"+deleteBatchId);\r\n    } else {\r\n      console.log('Deletion is stopped!');\r\n    }\r\n  }\r\n  // edit batch -> only if not editing any batch\r\n  else if(e.target.id == 'editBatch' && !editingBatchFlag) {\r\n    var editBatchId = e.target.dataset.batchId;\r\n    console.log('editing: ' + editBatchId);\r\n\r\n    editingBatchFlag = true;\r\n\r\n    var elementEditing = document.getElementById('editBatch_'+editBatchId);\r\n    var elementEditingCode = elementEditing.querySelector('.edit-batch-code');\r\n    var elementEditingName = elementEditing.querySelector('.edit-batch-name');\r\n    var elementEditingStartDate = elementEditing.querySelector('.edit-batch-start-date');\r\n    var elementEditingEndDate = elementEditing.querySelector('.edit-batch-end-date');\r\n    var elementEditingStudents = elementEditing.querySelector('.edit-batch-students');\r\n\r\n    elementEditing.classList.add('editing-class');\r\n    elementEditingCode.innerHTML = '<input type=\"text\" class=\"form-control\" id=\"editingCode\" value=\"'+elementEditingCode.dataset.batchCode+'\">';\r\n    elementEditingName.innerHTML = '<input type=\"text\" class=\"form-control\" id=\"editingName\" value=\"'+elementEditingName.dataset.batchName+'\">';\r\n    elementEditingStartDate.innerHTML = '<input type=\"date\" class=\"form-control\" id=\"editingStartDate\" value=\"'+elementEditingStartDate.dataset.batchStartDate+'\">';\r\n    elementEditingEndDate.innerHTML = '<input type=\"date\" class=\"form-control\" id=\"editingEndDate\" value=\"'+elementEditingEndDate.dataset.batchEndDate+'\">';\r\n    elementEditingStudents.innerHTML = '<input type=\"number\" class=\"form-control\" id=\"editingStudents\" value=\"'+elementEditingStudents.dataset.batchStudents+'\">';\r\n  }\r\n  // cancel batch -> if editing any batch\r\n  else if(e.target.id == 'cancelBatch' && editingBatchFlag) {\r\n    var cancelBatchId = e.target.dataset.batchId;\r\n    console.log('cancelling: ' + cancelBatchId);\r\n\r\n    updateBatchList();\r\n  }\r\n  // submit batch -> if editing any batch\r\n  else if(e.target.id == 'submitBatch' && editingBatchFlag) {\r\n    var submitBatchId = e.target.dataset.batchId;\r\n    console.log('submitting: ' + submitBatchId);\r\n\r\n    var batchCode = document.getElementById('editingCode').value;\r\n    var batchName = document.getElementById('editingName').value;\r\n    var batchStartDate = document.getElementById('editingStartDate').value;\r\n    var batchEndDate = document.getElementById('editingEndDate').value;\r\n    var batchStuents = document.getElementById('editingStudents').value;\r\n    // console.log(batchCode, batchName, batchStartDate, batchEndDate, batchStuents);\r\n\r\n    var xhttp4 = new XMLHttpRequest();\r\n    xhttp4.onreadystatechange = function() {\r\n      if (this.readyState == 4 && this.status == 200) {\r\n        timetableBatchList.innerHTML = this.responseText;\r\n        editingBatchFlag = false;\r\n      }\r\n    };\r\n    xhttp4.open(\"POST\", \"batch_handler.php\", true);  // open(method, url, async)\r\n    xhttp4.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n    xhttp4.send(\"action=submitBatch&orderBy=\"+orderBy+\"&ascOrDesc=\"+ascOrDesc+\"&batchCode=\"+batchCode+\r\n    \"&batchName=\"+batchName+\"&batchStartDate=\"+batchStartDate+\"&batchEndDate=\"+batchEndDate+\r\n    \"&batchStuents=\"+batchStuents+\"&submitId=\"+submitBatchId);\r\n  }\r\n}\r\n\r\n// function to order tables on click\r\nfunction orderClassBy(e) {\r\n  var prevOrderBy = orderBy;\r\n\r\n  // remove active class from all columns\r\n  for(var i = 0; i < orderByItems.length; i++) {\r\n    orderByItems[i].classList.remove('active-ASC');\r\n    orderByItems[i].classList.remove('active-DESC');\r\n  }\r\n\r\n  orderBy = e.target.dataset.orderBy;\r\n\r\n  // toggle ASC | DESC if column clicked is same as previous click\r\n  if(prevOrderBy == orderBy) {\r\n    if(ascOrDesc == 'DESC') {\r\n      ascOrDesc = 'ASC';\r\n    } else {\r\n      ascOrDesc = 'DESC';\r\n    }\r\n    // make ASC if column clicked is different from previous click\r\n  } else {\r\n    ascOrDesc = 'ASC';\r\n  }\r\n\r\n  // add active class to clicked column\r\n  e.target.classList.add('active-'+ascOrDesc);\r\n\r\n  console.log('ordering by...' + orderBy, ascOrDesc);\r\n\r\n  updateBatchList();\r\n}\r\n\r\n// run on page laod\r\nfunction init() {\r\n  updateBatchList();\r\n};\r\ninit();\r\n\r\n/****************Events****************/\r\naddBatchBtn.addEventListener('click', addBatch, false);\r\ntimetableBatchList.addEventListener('click', individualBatchEdit, false);\r\nfor(var i = 0; i < orderByItems.length; i++) {\r\n  orderByItems[i].addEventListener('click', orderClassBy, false);\r\n}\r\n"],"file":"batch.min.js"}
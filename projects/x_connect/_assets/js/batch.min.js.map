{"version":3,"sources":["batch.js"],"names":["selectedDateOuter","document","getElementById","orderByItems","querySelectorAll","selectedBatchCode","selectedBatchName","selectedBatchStartDate","selectedBatchEndDate","addBatchBtn","timetableBatchList","editingBatchFlag","orderBy","ascOrDesc","progressBar","progressBarInner","querySelector","updateBatchList","console","log","xhttp1","XMLHttpRequest","onreadystatechange","this","readyState","status","setTimeout","style","width","innerHTML","responseText","open","send","addBatch","batchCode","value","batchName","batchStartDate","currentDate","batchEndDate","xhttp2","setRequestHeader","individualBatchEdit","e","stopPropagation","target","id","cancelBatchId","dataset","batchId","submitBatchId","xhttp4","editBatchId","elementEditing","elementEditingCode","elementEditingName","classList","add","deleteBatchId","xhttp3","confirm","orderClassBy","prevOrderBy","i","length","remove","init","addEventListener"],"mappings":"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","sourcesContent":["/****************Variables****************/\r\n\r\nvar selectedDateOuter = document.getElementById('selectedDateOuter');\r\nvar orderByItems = document.querySelectorAll('[data-order-by]');\r\n\r\nvar selectedBatchCode = document.getElementById('selectedBatchCode');\r\nvar selectedBatchName = document.getElementById('selectedBatchName');\r\nvar selectedBatchStartDate = document.getElementById('selectedBatchStartDate');\r\nvar selectedBatchEndDate = document.getElementById('selectedBatchEndDate');\r\n\r\nvar addBatchBtn = document.getElementById('addBatchBtn');\r\n\r\nvar timetableBatchList = document.getElementById('timetableBatchList');\r\n\r\nvar editingBatchFlag = false;\r\nvar orderBy = 'batch_name';\r\nvar ascOrDesc = 'ASC';\r\n\r\nvar progressBar = document.getElementById('progressBar');\r\nvar progressBarInner = progressBar.querySelector('.progress-bar');\r\n\r\n/****************Functions****************/\r\n\r\n// Update time table on change of batch\r\nfunction updateBatchList() {\r\n  console.log('batch list updating...');\r\n\r\n  editingBatchFlag = false;\r\n\r\n  // load content from database\r\n  var xhttp1 = new XMLHttpRequest();\r\n  xhttp1.onreadystatechange = function() {\r\n    if (this.readyState == 4 && this.status == 200) {\r\n     setTimeout(()=>{\r\n       progressBarInner.style.width = '0%';\r\n       timetableBatchList.innerHTML = this.responseText;\r\n     }, 2000);\r\n   } else {\r\n     // console.log(this.readyState, this.status);\r\n   }\r\n  };\r\n  console.log(xhttp1);\r\n  xhttp1.open(\"GET\", \"batch_handler.php?action=updateBatchList&orderBy=\"+\r\n    orderBy+\"&ascOrDesc=\"+\r\n    ascOrDesc\r\n  , true);  // open(method, url, async)\r\n  xhttp1.send();\r\n}\r\n\r\n// Add batch on Submit btn click\r\nfunction addBatch() {\r\n  if(!editingBatchFlag) {\r\n    console.log('adding batch...');\r\n\r\n    var batchCode = selectedBatchCode.value;\r\n    var batchName = selectedBatchName.value;\r\n    var batchStartDate = currentDate();\r\n    var batchEndDate = currentDate();\r\n    // console.log(batchCode, batchName, batchStartDate, batchEndDate, batchStuents);\r\n\r\n    var xhttp2 = new XMLHttpRequest();\r\n    xhttp2.onreadystatechange = function() {\r\n      if (this.readyState == 4 && this.status == 200) {\r\n        // update batch list\r\n        timetableBatchList.innerHTML = this.responseText;\r\n        // clearning+updating fileds after successful addtion of batch\r\n        selectedBatchCode.value = selectedBatchName.value = '';\r\n      }\r\n    };\r\n    xhttp2.open(\"POST\", \"batch_handler.php\", true);  // open(method, url, async)\r\n    xhttp2.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n    xhttp2.send(\"action=addBatch&orderBy=\" + orderBy +\r\n      \"&ascOrDesc=\" + ascOrDesc +\r\n      \"&batchCode=\" + batchCode +\r\n      \"&batchName=\" + batchName +\r\n      \"&batchStartDate=\" + batchStartDate +\r\n      \"&batchEndDate=\" + batchEndDate\r\n    );\r\n  }\r\n}\r\n\r\n// Edit -> Delete -> Cancel -> Submit batch fuctions\r\nfunction individualBatchEdit(e) {\r\n  e.stopPropagation();\r\n  // delete batch -> only if not editing any batch\r\n  if(e.target.id == 'deleteBatch' && !editingBatchFlag) {\r\n    var deleteBatchId = e.target.dataset.batchId;\r\n    console.log('deleting: ' + deleteBatchId);\r\n\r\n    var xhttp3 = new XMLHttpRequest();\r\n    xhttp3.onreadystatechange = function() {\r\n      if (this.readyState == 4 && this.status == 200) {\r\n       timetableBatchList.innerHTML = this.responseText;\r\n      }\r\n    };\r\n\r\n    var deleteConfirmation = confirm(\"Want to delete?\");\r\n    if (deleteConfirmation) {\r\n        //Logic to delete the item\r\n        xhttp3.open(\"POST\", \"batch_handler.php\", true);  // open(method, url, async)\r\n        xhttp3.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n        xhttp3.send(\"action=deleteBatch&orderBy=\"+orderBy+\"&ascOrDesc=\"+ascOrDesc+\"&deleteId=\"+deleteBatchId);\r\n    } else {\r\n      console.log('Deletion is stopped!');\r\n    }\r\n  }\r\n  // edit batch -> only if not editing any batch\r\n  else if(e.target.id == 'editBatch' && !editingBatchFlag) {\r\n    var editBatchId = e.target.dataset.batchId;\r\n    console.log('editing: ' + editBatchId);\r\n\r\n    editingBatchFlag = true;\r\n\r\n    var elementEditing = document.getElementById('editBatch_'+editBatchId);\r\n    var elementEditingCode = elementEditing.querySelector('.edit-batch-code');\r\n    var elementEditingName = elementEditing.querySelector('.edit-batch-name');\r\n    // var elementEditingStartDate = elementEditing.querySelector('.edit-batch-start-date');\r\n    // var elementEditingEndDate = elementEditing.querySelector('.edit-batch-end-date');\r\n    // var elementEditingStudents = elementEditing.querySelector('.edit-batch-students');\r\n\r\n    elementEditing.classList.add('editing-class');\r\n    elementEditingCode.innerHTML = '<input type=\"text\" class=\"form-control\" id=\"editingCode\" value=\"'+elementEditingCode.dataset.batchCode+'\">';\r\n    elementEditingName.innerHTML = '<input type=\"text\" class=\"form-control\" id=\"editingName\" value=\"'+elementEditingName.dataset.batchName+'\">';\r\n    // elementEditingStartDate.innerHTML = '<input type=\"date\" class=\"form-control\" id=\"editingStartDate\" value=\"'+elementEditingStartDate.dataset.batchStartDate+'\">';\r\n    // elementEditingEndDate.innerHTML = '<input type=\"date\" class=\"form-control\" id=\"editingEndDate\" value=\"'+elementEditingEndDate.dataset.batchEndDate+'\">';\r\n    // elementEditingStudents.innerHTML = '<input type=\"number\" class=\"form-control\" id=\"editingStudents\" value=\"'+elementEditingStudents.dataset.batchStudents+'\">';\r\n  }\r\n  // cancel batch -> if editing any batch\r\n  else if(e.target.id == 'cancelBatch' && editingBatchFlag) {\r\n    var cancelBatchId = e.target.dataset.batchId;\r\n    console.log('cancelling: ' + cancelBatchId);\r\n    updateBatchList();\r\n  }\r\n  // submit batch -> if editing any batch\r\n  else if(e.target.id == 'submitBatch' && editingBatchFlag) {\r\n    var submitBatchId = e.target.dataset.batchId;\r\n    console.log('submitting: ' + submitBatchId);\r\n\r\n    var batchCode = document.getElementById('editingCode').value;\r\n    var batchName = document.getElementById('editingName').value;\r\n    // var batchStartDate = document.getElementById('editingStartDate').value;\r\n    // var batchEndDate = document.getElementById('editingEndDate').value;\r\n    // var batchStuents = document.getElementById('editingStudents').value;\r\n    // console.log(batchCode, batchName, batchStartDate, batchEndDate, batchStuents);\r\n\r\n    var xhttp4 = new XMLHttpRequest();\r\n    xhttp4.onreadystatechange = function() {\r\n      if (this.readyState == 4 && this.status == 200) {\r\n        timetableBatchList.innerHTML = this.responseText;\r\n        editingBatchFlag = false;\r\n      }\r\n    };\r\n    xhttp4.open(\"POST\", \"batch_handler.php\", true);  // open(method, url, async)\r\n    xhttp4.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n    xhttp4.send(\"action=submitBatch&orderBy=\" + orderBy +\r\n      \"&ascOrDesc=\" + ascOrDesc +\r\n      \"&batchCode=\" + batchCode +\r\n      \"&batchName=\" + batchName +\r\n      \"&submitId=\"+submitBatchId\r\n    );\r\n  }\r\n}\r\n\r\n// function to order tables on click\r\nfunction orderClassBy(e) {\r\n  var prevOrderBy = orderBy;\r\n\r\n  // remove active class from all columns\r\n  for(var i = 0; i < orderByItems.length; i++) {\r\n    orderByItems[i].classList.remove('active-ASC');\r\n    orderByItems[i].classList.remove('active-DESC');\r\n  }\r\n\r\n  orderBy = e.target.dataset.orderBy;\r\n\r\n  // toggle ASC | DESC if column clicked is same as previous click\r\n  if(prevOrderBy == orderBy) {\r\n    if(ascOrDesc == 'DESC') {\r\n      ascOrDesc = 'ASC';\r\n    } else {\r\n      ascOrDesc = 'DESC';\r\n    }\r\n    // make ASC if column clicked is different from previous click\r\n  } else {\r\n    ascOrDesc = 'ASC';\r\n  }\r\n\r\n  // add active class to clicked column\r\n  e.target.classList.add('active-'+ascOrDesc);\r\n\r\n  console.log('ordering by...' + orderBy, ascOrDesc);\r\n\r\n  updateBatchList();\r\n}\r\n\r\n// run on page laod\r\nfunction init() {\r\n  updateBatchList();\r\n};\r\ninit();\r\n\r\n/****************Events****************/\r\naddBatchBtn.addEventListener('click', addBatch, false);\r\ntimetableBatchList.addEventListener('click', individualBatchEdit, false);\r\nfor(var i = 0; i < orderByItems.length; i++) {\r\n  orderByItems[i].addEventListener('click', orderClassBy, false);\r\n}\r\n"],"file":"batch.min.js"}
var timetableOuter=document.getElementById("timetableOuter"),selectedDateOuter=document.getElementById("selectedDateOuter"),selectedBatchOuter=document.getElementById("selectedBatchOuter"),orderByItems=document.querySelectorAll("[data-order-by]"),filterStartDate=document.getElementById("filterStartDate"),filterEndDate=document.getElementById("filterEndDate"),selectedBatch=document.getElementById("selectedBatch"),selectedLayout=document.getElementById("selectedLayout"),addClassBtn=document.getElementById("addClassBtn"),timetableResultList=document.getElementById("timetableResultList"),timetableResultGrid_A=document.getElementById("timetableResultGrid_A"),timetableResultGrid_B=document.getElementById("timetableResultGrid_B"),selectedClassEl=document.getElementById("selectedClass"),selectedInstructorEL=document.getElementById("selectedInstructor"),selectedRoomEL=document.getElementById("selectedRoom"),editingClassFlag=!1,batchCode=null,batchTemplate=null,layout="list",orderBy="date",ascOrDesc="ASC";function updateTimeTableList(){console.log("timetable list updating..."),editingClassFlag=!1,batchCode=selectedBatch.value,batchTemplate=document.querySelector("[value='"+batchCode+"']").dataset.template;var e=batchData[batchTemplate].classes,t="";for(var a in e)t+='<option value="'+a+'">'+e[a]+"</option>";selectedClassEl.innerHTML=t;var s=batchData[batchTemplate].instructors,d="";for(var l in s)d+='<option value="'+l+'">'+s[l]+"</option>";selectedInstructorEL.innerHTML=d;var i=batchData[batchTemplate].rooms,n="";for(var r in i)n+='<option value="'+r+'">'+i[r]+"</option>";selectedRoomEL.innerHTML=n;var o=new XMLHttpRequest;o.onreadystatechange=function(){4==this.readyState&&200==this.status&&(timetableResultList.innerHTML=this.responseText)},o.open("GET","timetable_handler.php?action=updateTimeTableList&batchCode="+batchCode+"&batchTemplate="+batchTemplate+"&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc,!0),o.send()}function updateTimeTableGrid(){console.log("grid updating...");var e=document.getElementById("filterStartDate").value,t=document.getElementById("filterEndDate").value,a=new XMLHttpRequest;a.onreadystatechange=function(){4==this.readyState&&200==this.status&&(timetableResultGrid_A.innerHTML=this.responseText)},a.open("GET","timetable_handler.php?action=updateTimeTableGrid_A&filterStartDate="+e+"&filterEndDate="+t,!0),a.send();var s=new XMLHttpRequest;s.onreadystatechange=function(){4==this.readyState&&200==this.status&&(timetableResultGrid_B.innerHTML=this.responseText)},s.open("GET","timetable_handler.php?action=updateTimeTableGrid_B&filterStartDate="+e+"&filterEndDate="+t,!0),s.send()}function addClass(){if(!editingClassFlag){console.log("adding");var e=document.getElementById("selectedDate").value,t=document.getElementById("selectedClass").value,a=document.getElementById("selectedInstructor").value,s=document.getElementById("selectedStartTime").value,d=document.getElementById("selectedEndTime").value,l=document.getElementById("selectedRoom").value,i=new XMLHttpRequest;i.onreadystatechange=function(){4==this.readyState&&200==this.status&&(timetableResultList.innerHTML=this.responseText)},i.open("POST","timetable_handler.php",!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send("action=addClass&batchCode="+batchCode+"&batchTemplate="+batchTemplate+"&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc+"&date="+e+"&classCode="+t+"&instructorCode="+a+"&startTime="+s+"&endTime="+d+"&roomCode="+l)}}function individualClassEdit(e){if(e.stopPropagation(),"deleteClass"!=e.target.id||editingClassFlag)if("editClass"!=e.target.id||editingClassFlag){if("cancelClass"==e.target.id&&editingClassFlag){var t=e.target.dataset.classId;console.log("cancelling: "+t),updateTimeTableList()}else if("submitClass"==e.target.id&&editingClassFlag){var a=e.target.dataset.classId;console.log("submitting: "+a);var s=document.getElementById("editingDate").value,d=(h=document.getElementById("editingClass").value,v=document.getElementById("editingInstructors").value,document.getElementById("editingStartTime").value),l=document.getElementById("editingEndTime").value,i=(E=document.getElementById("editingRoom").value,new XMLHttpRequest);i.onreadystatechange=function(){4==this.readyState&&200==this.status&&(timetableResultList.innerHTML=this.responseText,editingClassFlag=!1)},i.open("POST","timetable_handler.php",!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send("action=submitClass&batchCode="+batchCode+"&batchTemplate="+batchTemplate+"&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc+"&date="+s+"&classCode="+h+"&instructorCode="+v+"&startTime="+d+"&endTime="+l+"&roomCode="+E+"&submitId="+a)}}else{var n=e.target.dataset.classId;console.log("editing: "+n),editingClassFlag=!0;var r=document.getElementById("editClass_"+n),o=r.querySelector(".edit-date"),c=r.querySelector(".edit-class"),u=r.querySelector(".edit-instructor"),m=r.querySelector(".edit-time"),g=r.querySelector(".edit-room");r.classList.add("editing-class"),o.innerHTML='<input type="date" class="form-control" id="editingDate" value="'+o.dataset.date+'">',m.classList.add("time-picker"),m.innerHTML='<input type="time" class="form-control" id="editingStartTime" value="'+m.dataset.starttime+'"><input type="time" class="form-control" id="editingEndTime" value="'+m.dataset.endtime+'">';var p=batchData[batchTemplate].classes,y="";for(var h in p)h==c.dataset.class?y+='<option value="'+h+'" selected>'+p[h]+"</option>":y+='<option value="'+h+'">'+p[h]+"</option>";c.innerHTML='<select class="custom-select" id="editingClass">'+y+"</select>";var b=batchData[batchTemplate].instructors,T="";for(var v in b)v==u.dataset.instructor?T+='<option value="'+v+'" selected>'+b[v]+"</option>":T+='<option value="'+v+'">'+b[v]+"</option>";u.innerHTML='<select class="custom-select" id="editingInstructors">'+T+"</select>";var B=batchData[batchTemplate].rooms,L="";for(var E in B)E==g.dataset.room?L+='<option value="'+E+'" selected>'+B[E]+"</option>":L+='<option value="'+E+'">'+B[E]+"</option>";g.innerHTML='<select class="custom-select" id="editingRoom">'+L+"</select>"}else{var C=e.target.dataset.classId;console.log("deleting: "+C);var f=new XMLHttpRequest;f.onreadystatechange=function(){4==this.readyState&&200==this.status&&(timetableResultList.innerHTML=this.responseText)},confirm("Want to delete?")?(f.open("POST","timetable_handler.php",!0),f.setRequestHeader("Content-type","application/x-www-form-urlencoded"),f.send("action=deleteClass&batchCode="+batchCode+"&batchTemplate="+batchTemplate+"&orderBy="+orderBy+"&ascOrDesc="+ascOrDesc+"&deleteId="+C)):console.log("Deletion is stopped!")}}function updateLayout(e){"list"==(layout=e.target?e.target.value:selectedLayout.value)?(timetableOuter.classList.add("list"),timetableOuter.classList.remove("grid")):(timetableOuter.classList.add("grid"),timetableOuter.classList.remove("list"))}function orderClassBy(e){for(var t=orderBy,a=0;a<orderByItems.length;a++)orderByItems[a].classList.remove("active-ASC"),orderByItems[a].classList.remove("active-DESC");orderBy=e.target.dataset.orderBy,ascOrDesc=t==orderBy?"DESC"==ascOrDesc?"ASC":"DESC":"ASC",e.target.classList.add("active-"+ascOrDesc),console.log("ordering by..."+orderBy,ascOrDesc),updateTimeTableList()}function init(){selectedDate.value=currentDate(),filterStartDate.value="2018-03-05",filterEndDate.value="2018-03-25",updateTimeTableList(selectedBatch),updateTimeTableGrid(),updateLayout(selectedLayout)}init(),selectedBatch.addEventListener("change",updateTimeTableList,!1),filterStartDate.addEventListener("change",updateTimeTableGrid,!1),filterEndDate.addEventListener("change",updateTimeTableGrid,!1),selectedLayout.addEventListener("change",updateLayout,!1),addClassBtn.addEventListener("click",addClass,!1),timetableResultList.addEventListener("click",individualClassEdit,!1);for(var i=0;i<orderByItems.length;i++)orderByItems[i].addEventListener("click",orderClassBy,!1);
//# sourceMappingURL=timetable.min.js.map

var bookParent,bookTitle,bookStock,bookCategory,bookTitleValue,bookAuthorValue,bookStockValue,bookCategoryValue,booksListContainer=document.getElementById("booksListContainer"),selectCategory=document.getElementById("selectCategory"),addBtn=document.getElementById("addBtn");function fetchCategoriesForBooks(){console.log("fetching categories for books list..."),xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&(selectCategory.innerHTML=this.responseText)},xhttp.open("GET","books_handler.php?action=fetchCategoriesForBooks",!0),xhttp.send()}function individualOperations(t){if(t.stopPropagation(),"deleteBtn"!=t.target.id||isEditing)if("editBtn"!=t.target.id||isEditing){if("cancelBtn"==t.target.id&&isEditing){isEditing=!1;i=(bookParent=t.target.parentNode.parentNode).dataset.bookId;console.log("cancelling: "+i),bookParent.classList.remove("editing-outer"),bookTitle.innerHTML=bookTitleValue,bookAuthor.innerHTML=bookAuthorValue,bookStock.innerHTML=bookStockValue,bookStock.innerHTML=bookStockValue,bookCategory.innerHTML=bookCategoryValue}else if("updateBtn"==t.target.id&&isEditing){isEditing=!1;i=(bookParent=t.target.parentNode.parentNode).dataset.bookId;console.log("updating: "+i);var e=bookTitle.querySelector("input").value,o=bookAuthor.querySelector("input").value,n=bookStock.querySelector("input").value,a=bookCategory.querySelector("select").value;xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&(booksListContainer.innerHTML=this.responseText)},xhttp.open("POST","books_handler.php",!0),xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhttp.send("action=update&newTitle="+e+"&newAuthor="+o+"&newStock="+n+"&newCategory="+a+"&bookId="+i)}}else{isEditing=!0;var i=(bookParent=t.target.parentNode.parentNode).dataset.bookId,r=bookParent.dataset.categoryId;console.log("editing: "+i),bookTitle=bookParent.querySelector(".book-title"),bookAuthor=bookParent.querySelector(".book-author"),bookStock=bookParent.querySelector(".book-stock"),bookCategory=bookParent.querySelector(".book-category"),bookTitleValue=bookTitle.innerHTML,bookAuthorValue=bookAuthor.innerHTML,bookStockValue=bookStock.innerHTML,bookCategoryValue=bookCategory.innerHTML,bookParent.classList.add("editing-outer"),bookTitle.innerHTML='<input type="text" class="form-control" value="'+bookTitleValue+'">',bookAuthor.innerHTML='<input type="text" class="form-control" value="'+bookAuthorValue+'">',bookStock.innerHTML='<input type="number" class="form-control" value="'+bookStockValue+'" min="0" max="100">',bookCategory.innerHTML="";var s=selectCategory.cloneNode(!0);bookCategory.appendChild(s),bookCategory.querySelector("select").value=r}else{var d=(bookParent=t.target.parentNode.parentNode).dataset.bookId;console.log("deleting: "+d),xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&(booksListContainer.innerHTML=this.responseText)},confirm("Want to delete?")?(xhttp.open("POST","books_handler.php",!0),xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhttp.send("action=delete&deleteId="+d)):console.log("Deletion is stopped!")}}function fetchBooks(){console.log("fetching books list..."),xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&(booksListContainer.innerHTML=this.responseText)},xhttp.open("GET","books_handler.php?action=fetchBooks",!0),xhttp.send()}function addBook(){if(!isEditing){console.log("adding book..");var t=document.getElementById("addTitle").value,e=document.getElementById("addAuthor").value,o=document.getElementById("addStock").value,n=selectCategory.value;document.getElementById("addTitle").value="",document.getElementById("addAuthor").value="",document.getElementById("addStock").value=1,xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&(booksListContainer.innerHTML=this.responseText)},xhttp.open("POST","books_handler.php",!0),xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhttp.send("action=add&addTitle="+t+"&addAuthor="+e+"&addStock="+o+"&addCategory="+n)}}function init(){fetchCategoriesForBooks(),fetchBooks()}init(),booksListContainer.addEventListener("click",individualOperations,!1),addBtn.addEventListener("click",addBook,!1);
//# sourceMappingURL=books.min.js.map
